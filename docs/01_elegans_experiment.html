<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Analyzing and visualizing data | Portfolio</title>
  <meta name="description" content="Chapter 1 Analyzing and visualizing data | Portfolio" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Analyzing and visualizing data | Portfolio" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Analyzing and visualizing data | Portfolio" />
  
  
  

<meta name="author" content="Youri Lam" />


<meta name="date" content="2023-01-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="02_reproducible_research.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />










<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><h2 class=".paddingtitel ">Portfolio of Youri Lam</h2></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Curriculum Vitae</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contact"><i class="fa fa-check"></i>Contact</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#profile"><i class="fa fa-check"></i>Profile</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#education"><i class="fa fa-check"></i>Education</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#experience"><i class="fa fa-check"></i>Experience</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#skills"><i class="fa fa-check"></i>Skills</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#languages"><i class="fa fa-check"></i>Languages</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="01_elegans_experiment.html"><a href="01_elegans_experiment.html"><i class="fa fa-check"></i><b>1</b> Analyzing and visualizing data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01_elegans_experiment.html"><a href="01_elegans_experiment.html#preparing-the-data"><i class="fa fa-check"></i><b>1.1</b> Preparing the data</a></li>
<li class="chapter" data-level="1.2" data-path="01_elegans_experiment.html"><a href="01_elegans_experiment.html#normalizing-the-data"><i class="fa fa-check"></i><b>1.2</b> Normalizing the data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02_reproducible_research.html"><a href="02_reproducible_research.html"><i class="fa fa-check"></i><b>2</b> Reproducible Research</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="02_reproducible_research.html"><a href="02_reproducible_research.html#the-article"><i class="fa fa-check"></i><b>2.0.1</b> The article</a></li>
<li class="chapter" data-level="2.0.2" data-path="02_reproducible_research.html"><a href="02_reproducible_research.html#the-code"><i class="fa fa-check"></i><b>2.0.2</b> The code</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03_guerilla_framework.html"><a href="03_guerilla_framework.html"><i class="fa fa-check"></i><b>3</b> Data Management</a></li>
<li class="chapter" data-level="4" data-path="04_genexpressie.html"><a href="04_genexpressie.html"><i class="fa fa-check"></i><b>4</b> Gen Expressie</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04_genexpressie.html"><a href="04_genexpressie.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="04_genexpressie.html"><a href="04_genexpressie.html#endgoal"><i class="fa fa-check"></i><b>4.2</b> Endgoal</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05_parameter.html"><a href="05_parameter.html"><i class="fa fa-check"></i><b>5</b> Parameterized report on COVID-19</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05_parameter.html"><a href="05_parameter.html#parameterized-reports"><i class="fa fa-check"></i><b>5.1</b> Parameterized reports</a></li>
<li class="chapter" data-level="5.2" data-path="05_parameter.html"><a href="05_parameter.html#the-parameterized-covid-19-report"><i class="fa fa-check"></i><b>5.2</b> The parameterized COVID-19 report</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="05_parameter.html"><a href="05_parameter.html#the-parameters"><i class="fa fa-check"></i><b>5.2.1</b> The parameters</a></li>
<li class="chapter" data-level="5.2.2" data-path="05_parameter.html"><a href="05_parameter.html#rendering-the-report"><i class="fa fa-check"></i><b>5.2.2</b> Rendering the report</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="05_parameter.html"><a href="05_parameter.html#altering-parameters"><i class="fa fa-check"></i><b>5.3</b> Altering parameters</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06_Relational_Databases.html"><a href="06_Relational_Databases.html"><i class="fa fa-check"></i><b>6</b> Relational data and databases</a>
<ul>
<li class="chapter" data-level="" data-path="06_Relational_Databases.html"><a href="06_Relational_Databases.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="06_Relational_Databases.html"><a href="06_Relational_Databases.html#dbeaver-connection"><i class="fa fa-check"></i>DBeaver connection</a></li>
<li class="chapter" data-level="" data-path="06_Relational_Databases.html"><a href="06_Relational_Databases.html#inspection"><i class="fa fa-check"></i>Inspection</a></li>
<li class="chapter" data-level="" data-path="06_Relational_Databases.html"><a href="06_Relational_Databases.html#visualisations"><i class="fa fa-check"></i>Visualisations</a>
<ul>
<li class="chapter" data-level="" data-path="06_Relational_Databases.html"><a href="06_Relational_Databases.html#life-expectancy"><i class="fa fa-check"></i>Life expectancy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07_Rpackage.html"><a href="07_Rpackage.html"><i class="fa fa-check"></i><b>7</b> Self-made R package</a>
<ul>
<li class="chapter" data-level="" data-path="07_Rpackage.html"><a href="07_Rpackage.html#introduction-2"><i class="fa fa-check"></i>Introduction</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analyzing-and-visualizing-data" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Analyzing and visualizing data</h1>
<div id="preparing-the-data" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Preparing the data</h2>
<p>Before the data can be visualized, it has to be cleaned up. The dataframe is already in tidy format, but the data types of the columns need to be changed. The variables RawData (the outcome - number of offspring counted as an integer value, after incubation time), compName (the generic name of the compound/chemical) and the compConcentration (the concentration of the compound) are all very important in this research. Expected data types would be double/integer for RawData, character for compName and double for compConcentration.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="01_elegans_experiment.html#cb1-1" aria-hidden="true" tabindex="-1"></a>dataset_elegans <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">&quot;raw_data/CE.LIQ.FLOW.062_Tidydata.xlsx&quot;</span>))</span>
<span id="cb1-2"><a href="01_elegans_experiment.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(dataset_elegans<span class="sc">$</span>RawData)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="01_elegans_experiment.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(dataset_elegans<span class="sc">$</span>compName)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="01_elegans_experiment.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(dataset_elegans<span class="sc">$</span>compConcentration)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>The actual data types of the columns are double for RawData, character for compName and character for compConcentration, as seen above. When plotted, this will result in the following issue:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="01_elegans_experiment.html#cb7-1" aria-hidden="true" tabindex="-1"></a>plot_wrong <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataset_elegans, <span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">y =</span> RawData))<span class="sc">+</span></span>
<span id="cb7-2"><a href="01_elegans_experiment.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> compName,</span>
<span id="cb7-3"><a href="01_elegans_experiment.html#cb7-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> expType),</span>
<span id="cb7-4"><a href="01_elegans_experiment.html#cb7-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb7-5"><a href="01_elegans_experiment.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rotate_axis_labels</span>(<span class="st">&quot;x&quot;</span>, <span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb7-6"><a href="01_elegans_experiment.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Concentration&quot;</span>,</span>
<span id="cb7-7"><a href="01_elegans_experiment.html#cb7-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number of offspring&quot;</span>,</span>
<span id="cb7-8"><a href="01_elegans_experiment.html#cb7-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Number of offspring of adult Elegans were exposed to varying concentrations of different compounds, alphabetical&quot;</span>,</span>
<span id="cb7-9"><a href="01_elegans_experiment.html#cb7-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">&quot;Type&quot;</span>,</span>
<span id="cb7-10"><a href="01_elegans_experiment.html#cb7-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Compound&quot;</span>)<span class="sc">+</span></span>
<span id="cb7-11"><a href="01_elegans_experiment.html#cb7-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.75</span>,<span class="st">&quot;line&quot;</span>),</span>
<span id="cb7-12"><a href="01_elegans_experiment.html#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb7-13"><a href="01_elegans_experiment.html#cb7-13" aria-hidden="true" tabindex="-1"></a>plot_wrong</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:errorplot"></span>
<img src="bookdown_site_files/figure-html/errorplot-1.png" alt="Number of C. elegans offspring under a number of circumstances where the x-axis is ordered alphabetically" width="672" />
<p class="caption">
Figure 1.1: Number of C. elegans offspring under a number of circumstances where the x-axis is ordered alphabetically
</p>
</div>
<p>As seen in the figure above, the x-axis labels are ordered alphabetically. This is because the data type of the compConcentration is character instead of double. TO make sure the graph looks better in the future, the classes need to be changed as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="01_elegans_experiment.html#cb8-1" aria-hidden="true" tabindex="-1"></a>dataset_elegans<span class="sc">$</span>RawData <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(dataset_elegans<span class="sc">$</span>RawData)</span>
<span id="cb8-2"><a href="01_elegans_experiment.html#cb8-2" aria-hidden="true" tabindex="-1"></a>dataset_elegans<span class="sc">$</span>compName <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dataset_elegans<span class="sc">$</span>compName)</span>
<span id="cb8-3"><a href="01_elegans_experiment.html#cb8-3" aria-hidden="true" tabindex="-1"></a>dataset_elegans<span class="sc">$</span>compConcentration <span class="ot">&lt;-</span> <span class="fu">as.double</span>(dataset_elegans<span class="sc">$</span>compConcentration)</span>
<span id="cb8-4"><a href="01_elegans_experiment.html#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="01_elegans_experiment.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(dataset_elegans<span class="sc">$</span>RawData)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="01_elegans_experiment.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(dataset_elegans<span class="sc">$</span>compName)</span></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="01_elegans_experiment.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(dataset_elegans<span class="sc">$</span>compConcentration)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>Looking at the compUnit part of the data, I noticed that not all of the data shares the same compUnit. Some of them are compounds measured in nM and some compounds are measured in percentage. To show this, I made sure to divide the data into two graphs, one for each unit. By changing the date types to the correct ones (including the types talked about previously) and adding jitter, we can make the graph look like this:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="01_elegans_experiment.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Scatter plot filtered on nM as unit</span></span>
<span id="cb14-2"><a href="01_elegans_experiment.html#cb14-2" aria-hidden="true" tabindex="-1"></a>elegans_nM <span class="ot">&lt;-</span> dataset_elegans <span class="sc">%&gt;%</span> <span class="fu">filter</span>(compUnit <span class="sc">==</span> <span class="st">&quot;nM&quot;</span>)</span>
<span id="cb14-3"><a href="01_elegans_experiment.html#cb14-3" aria-hidden="true" tabindex="-1"></a>scatter_nM <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> elegans_nM, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration), <span class="at">y =</span> RawData))<span class="sc">+</span></span>
<span id="cb14-4"><a href="01_elegans_experiment.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> compName, </span>
<span id="cb14-5"><a href="01_elegans_experiment.html#cb14-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> expType),</span>
<span id="cb14-6"><a href="01_elegans_experiment.html#cb14-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">height =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb14-7"><a href="01_elegans_experiment.html#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;log10 concentration of compounds (nM)&quot;</span>,</span>
<span id="cb14-8"><a href="01_elegans_experiment.html#cb14-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number of offspring&quot;</span>)<span class="sc">+</span></span>
<span id="cb14-9"><a href="01_elegans_experiment.html#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb14-10"><a href="01_elegans_experiment.html#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="01_elegans_experiment.html#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="01_elegans_experiment.html#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Scatter plot filtered on pct as unit</span></span>
<span id="cb14-13"><a href="01_elegans_experiment.html#cb14-13" aria-hidden="true" tabindex="-1"></a>elegans_pct <span class="ot">&lt;-</span> dataset_elegans <span class="sc">%&gt;%</span> <span class="fu">filter</span>(compUnit <span class="sc">==</span> <span class="st">&quot;pct&quot;</span>)</span>
<span id="cb14-14"><a href="01_elegans_experiment.html#cb14-14" aria-hidden="true" tabindex="-1"></a>scatter_pct <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> elegans_pct, <span class="fu">aes</span>(<span class="at">x =</span> expType, <span class="at">y =</span> RawData))<span class="sc">+</span></span>
<span id="cb14-15"><a href="01_elegans_experiment.html#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> compName, </span>
<span id="cb14-16"><a href="01_elegans_experiment.html#cb14-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> expType),</span>
<span id="cb14-17"><a href="01_elegans_experiment.html#cb14-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">height =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb14-18"><a href="01_elegans_experiment.html#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;log10 concentration of compounds (nM)&quot;</span>,</span>
<span id="cb14-19"><a href="01_elegans_experiment.html#cb14-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number of offspring&quot;</span>)<span class="sc">+</span></span>
<span id="cb14-20"><a href="01_elegans_experiment.html#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb14-21"><a href="01_elegans_experiment.html#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">8.75</span>),</span>
<span id="cb14-22"><a href="01_elegans_experiment.html#cb14-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb14-23"><a href="01_elegans_experiment.html#cb14-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb14-24"><a href="01_elegans_experiment.html#cb14-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb14-25"><a href="01_elegans_experiment.html#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rotate_axis_labels</span>(<span class="st">&quot;x&quot;</span>, <span class="dv">90</span>)</span>
<span id="cb14-26"><a href="01_elegans_experiment.html#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="01_elegans_experiment.html#cb14-27" aria-hidden="true" tabindex="-1"></a>legend <span class="ot">&lt;-</span> <span class="fu">get_legend</span>(plot_wrong)</span>
<span id="cb14-28"><a href="01_elegans_experiment.html#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="01_elegans_experiment.html#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="fu">plot_grid</span>(scatter_nM, scatter_pct),</span>
<span id="cb14-30"><a href="01_elegans_experiment.html#cb14-30" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">plot_grid</span>(<span class="cn">NULL</span>, legend, <span class="at">ncol =</span> <span class="dv">3</span>),</span>
<span id="cb14-31"><a href="01_elegans_experiment.html#cb14-31" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.35</span>))<span class="sc">+</span></span>
<span id="cb14-32"><a href="01_elegans_experiment.html#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="st">&quot;Number of C. elegans offspring under</span><span class="sc">\n</span><span class="st">a number of circumstances&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:scatterplotelegans"></span>
<img src="bookdown_site_files/figure-html/scatterplotelegans-1.png" alt="Number of C. elegans offspring under a number of circumstances" width="672" />
<p class="caption">
Figure 1.2: Number of C. elegans offspring under a number of circumstances
</p>
</div>
<p>The positive control for this experiment is ethanol. The negative control for this experiment is S-medium.</p>
</div>
<div id="normalizing-the-data" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Normalizing the data</h2>
<p>To make it easier to read the grap, the data needs to be normalized. To do this we adjust the negative control to a value of 1 and adjust the other values in the same way:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="01_elegans_experiment.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtain the mean of the RawData (negativeControl)</span></span>
<span id="cb15-2"><a href="01_elegans_experiment.html#cb15-2" aria-hidden="true" tabindex="-1"></a>neg_control <span class="ot">&lt;-</span> dataset_elegans <span class="sc">%&gt;%</span> <span class="fu">filter</span>(compName <span class="sc">==</span> <span class="st">&quot;S-medium&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(RawData, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb15-3"><a href="01_elegans_experiment.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Use the mean to calculate fractions</span></span>
<span id="cb15-4"><a href="01_elegans_experiment.html#cb15-4" aria-hidden="true" tabindex="-1"></a>mutated <span class="ot">&lt;-</span> dataset_elegans <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RawData <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="01_elegans_experiment.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RawData, compName, compConcentration, expType) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="01_elegans_experiment.html#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">normalized =</span> RawData<span class="sc">/</span>neg_control<span class="sc">$</span>mean)</span></code></pre></div>
<p>Now that the data is normalized, we can make the graph:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="01_elegans_experiment.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create normalized plot</span></span>
<span id="cb16-2"><a href="01_elegans_experiment.html#cb16-2" aria-hidden="true" tabindex="-1"></a>normalized_plot <span class="ot">&lt;-</span> mutated <span class="sc">%&gt;%</span> <span class="fu">filter</span>(compName <span class="sc">==</span> <span class="st">&quot;2,6-diisopropylnaphthalene&quot;</span> <span class="sc">|</span> compName <span class="sc">==</span> <span class="st">&quot;decane&quot;</span> <span class="sc">|</span> compName <span class="sc">==</span> <span class="st">&quot;naphthalene&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration), <span class="at">y =</span> normalized))<span class="sc">+</span></span>
<span id="cb16-3"><a href="01_elegans_experiment.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> compName), <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">height =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb16-4"><a href="01_elegans_experiment.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;log10 concentration (nM)&quot;</span>,</span>
<span id="cb16-5"><a href="01_elegans_experiment.html#cb16-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Normalized number of offspring&quot;</span>,</span>
<span id="cb16-6"><a href="01_elegans_experiment.html#cb16-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Number of C. elegans offspring as a fraction</span><span class="sc">\n</span><span class="st">of the negative control group&quot;</span>,</span>
<span id="cb16-7"><a href="01_elegans_experiment.html#cb16-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Compound&quot;</span>)<span class="sc">+</span></span>
<span id="cb16-8"><a href="01_elegans_experiment.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb16-9"><a href="01_elegans_experiment.html#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="01_elegans_experiment.html#cb16-10" aria-hidden="true" tabindex="-1"></a>normalized_plot</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:normalizedplot"></span>
<img src="bookdown_site_files/figure-html/normalizedplot-1.png" alt="Number of C. elegans offspring as a fraction of the negative control group." width="672" />
<p class="caption">
Figure 1.3: Number of C. elegans offspring as a fraction of the negative control group.
</p>
</div>
<p>Everything below the red line means less offspring than control C. elegans and everything above it has more offspring. For further analysation of the effect i would start by testing normality by performing a Shapiro-Wilk test. If unusual, i would normalize the data like done above. If normal, i would start an ANOVA between de different conditions. I would end with the post-hoc tests, to check in what combination of groups the difference is.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="02_reproducible_research.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/YouriLam/YouriLam.github.io/edit/main/01_elegans_experiment.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown_site.pdf", "bookdown_site.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
